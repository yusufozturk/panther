
<!-- This document is generated by "mage doc". DO NOT EDIT! -->
# CiscoUmbrella
{% hint style="info" %}Required fields are in <b>bold</b>.{% endhint %}
##CiscoUmbrella.CloudFirewall
Cloud Firewall logs show traffic that has been handled by network tunnels.
Reference: https://docs.umbrella.com/deployment-umbrella/docs/log-formats-and-versioning#section-cloud-firewall-logs

<table>
<tr><th align=center>Column</th><th align=center>Type</th><th align=center>Description</th></tr>
<tr><td valign=top><code><b>timestamp</b></code></td><td><code>timestamp</code></td><td valign=top>The timestamp of the request transaction in UTC (2015-01-16 17:48:41).</td></tr>
<tr><td valign=top><code>originId</code></td><td><code>string</code></td><td valign=top>The unique identity of the network tunnel.</td></tr>
<tr><td valign=top><code>identity</code></td><td><code>string</code></td><td valign=top>The name of the network tunnel.</td></tr>
<tr><td valign=top><code>identityType</code></td><td><code>string</code></td><td valign=top>The type of identity that made the request. Should always be &#39;CDFW Tunnel Device&#39;.</td></tr>
<tr><td valign=top><code>direction</code></td><td><code>string</code></td><td valign=top>The direction of the packet. It is destined either towards the internet or to the customer&#39;s network.</td></tr>
<tr><td valign=top><code>ipProtocol</code></td><td><code>int</code></td><td valign=top>The actual IP protocol of the traffic. It could be TCP, UDP, ICMP.</td></tr>
<tr><td valign=top><code>packetSize</code></td><td><code>int</code></td><td valign=top>The size of the packet that Umbrella CDFW received.</td></tr>
<tr><td valign=top><code>sourceIp</code></td><td><code>string</code></td><td valign=top>The internal IP address of the user-generated traffic towards the CDFW. If the traffic goes through NAT before it comes to CDFW, it will be the NAT IP address.</td></tr>
<tr><td valign=top><code>sourcePort</code></td><td><code>int</code></td><td valign=top>The internal port number of the user-generated traffic towards the CDFW.</td></tr>
<tr><td valign=top><code>destinationIp</code></td><td><code>string</code></td><td valign=top>The destination IP address of the user-generated traffic towards the CDFW.</td></tr>
<tr><td valign=top><code>destinationPort</code></td><td><code>int</code></td><td valign=top>The destination port number of the user-generated traffic towards the CDFW.</td></tr>
<tr><td valign=top><code>dataCenter</code></td><td><code>string</code></td><td valign=top>The name of the Umbrella Data Center that processed the user-generated traffic.</td></tr>
<tr><td valign=top><code>ruleId</code></td><td><code>string</code></td><td valign=top>The ID of the rule that processed the user traffic.</td></tr>
<tr><td valign=top><code>verdict</code></td><td><code>string</code></td><td valign=top>The final verdict whether to allow or block the traffic based on the rule.</td></tr>
<tr><td valign=top><code><b>p_log_type</b></code></td><td><code>string</code></td><td valign=top>Panther added field with type of log</td></tr>
<tr><td valign=top><code><b>p_row_id</b></code></td><td><code>string</code></td><td valign=top>Panther added field with unique id (within table)</td></tr>
<tr><td valign=top><code><b>p_event_time</b></code></td><td><code>timestamp</code></td><td valign=top>Panther added standardize event time (UTC)</td></tr>
<tr><td valign=top><code><b>p_parse_time</b></code></td><td><code>timestamp</code></td><td valign=top>Panther added standardize log parse time (UTC)</td></tr>
<tr><td valign=top><code>p_any_ip_addresses</code></td><td><code>[string]</code></td><td valign=top>Panther added field with collection of ip addresses associated with the row</td></tr>
<tr><td valign=top><code>p_any_domain_names</code></td><td><code>[string]</code></td><td valign=top>Panther added field with collection of domain names associated with the row</td></tr>
<tr><td valign=top><code>p_any_sha1_hashes</code></td><td><code>[string]</code></td><td valign=top>Panther added field with collection of SHA1 hashes associated with the row</td></tr>
<tr><td valign=top><code>p_any_md5_hashes</code></td><td><code>[string]</code></td><td valign=top>Panther added field with collection of MD5 hashes associated with the row</td></tr>
<tr><td valign=top><code>p_any_sha256_hashes</code></td><td><code>[string]</code></td><td valign=top>Panther added field with collection of SHA256 hashes of any algorithm associated with the row</td></tr>
</table>

##CiscoUmbrella.DNS
DNS logs show traffic that has reached our DNS resolvers.
Reference: https://docs.umbrella.com/deployment-umbrella/docs/log-formats-and-versioning#section-dns-logs

<table>
<tr><th align=center>Column</th><th align=center>Type</th><th align=center>Description</th></tr>
<tr><td valign=top><code><b>timestamp</b></code></td><td><code>timestamp</code></td><td valign=top>When this request was made in UTC. This is different than the Umbrella dashboard, which converts the time to your specified time zone.</td></tr>
<tr><td valign=top><code>policyIdentity</code></td><td><code>string</code></td><td valign=top>The first identity that matched the request.</td></tr>
<tr><td valign=top><code>identities</code></td><td><code>[string]</code></td><td valign=top>All identities associated with this request.</td></tr>
<tr><td valign=top><code>internalIp</code></td><td><code>string</code></td><td valign=top>The internal IP address that made the request.</td></tr>
<tr><td valign=top><code>externalIp</code></td><td><code>string</code></td><td valign=top>The external IP address that made the request.</td></tr>
<tr><td valign=top><code>action</code></td><td><code>string</code></td><td valign=top>Whether the request was allowed or blocked.</td></tr>
<tr><td valign=top><code>queryType</code></td><td><code>string</code></td><td valign=top>The type of DNS request that was made. For more information, see Common DNS Request Types.</td></tr>
<tr><td valign=top><code>responseCode</code></td><td><code>string</code></td><td valign=top>The DNS return code for this request. For more information, see Common DNS return codes for any DNS service (and Umbrella).</td></tr>
<tr><td valign=top><code>domain</code></td><td><code>string</code></td><td valign=top>The domain that was requested.</td></tr>
<tr><td valign=top><code>categories</code></td><td><code>[string]</code></td><td valign=top>The security or content categories that the destination matches.</td></tr>
<tr><td valign=top><code>policyIdentityType</code></td><td><code>string</code></td><td valign=top>The first identity type matched with this request. Available in version 3 and above.</td></tr>
<tr><td valign=top><code>identityTypes</code></td><td><code>[string]</code></td><td valign=top>The type of identity that made the request. For example, Roaming Computer, Network, and so on. Available in version 3 and above.</td></tr>
<tr><td valign=top><code>blockedCategories</code></td><td><code>[string]</code></td><td valign=top>The categories that resulted in the destination being blocked. Available in version 4 and above.</td></tr>
<tr><td valign=top><code><b>p_log_type</b></code></td><td><code>string</code></td><td valign=top>Panther added field with type of log</td></tr>
<tr><td valign=top><code><b>p_row_id</b></code></td><td><code>string</code></td><td valign=top>Panther added field with unique id (within table)</td></tr>
<tr><td valign=top><code><b>p_event_time</b></code></td><td><code>timestamp</code></td><td valign=top>Panther added standardize event time (UTC)</td></tr>
<tr><td valign=top><code><b>p_parse_time</b></code></td><td><code>timestamp</code></td><td valign=top>Panther added standardize log parse time (UTC)</td></tr>
<tr><td valign=top><code>p_any_ip_addresses</code></td><td><code>[string]</code></td><td valign=top>Panther added field with collection of ip addresses associated with the row</td></tr>
<tr><td valign=top><code>p_any_domain_names</code></td><td><code>[string]</code></td><td valign=top>Panther added field with collection of domain names associated with the row</td></tr>
<tr><td valign=top><code>p_any_sha1_hashes</code></td><td><code>[string]</code></td><td valign=top>Panther added field with collection of SHA1 hashes associated with the row</td></tr>
<tr><td valign=top><code>p_any_md5_hashes</code></td><td><code>[string]</code></td><td valign=top>Panther added field with collection of MD5 hashes associated with the row</td></tr>
<tr><td valign=top><code>p_any_sha256_hashes</code></td><td><code>[string]</code></td><td valign=top>Panther added field with collection of SHA256 hashes of any algorithm associated with the row</td></tr>
</table>

##CiscoUmbrella.IP
IP logs show traffic that has been handled by the IP Layer Enforcement feature.
Reference: https://docs.umbrella.com/deployment-umbrella/docs/log-formats-and-versioning#section-ip-logs

<table>
<tr><th align=center>Column</th><th align=center>Type</th><th align=center>Description</th></tr>
<tr><td valign=top><code><b>timestamp</b></code></td><td><code>timestamp</code></td><td valign=top>The timestamp of the request transaction in UTC (2015-01-16 17:48:41).</td></tr>
<tr><td valign=top><code>identity</code></td><td><code>string</code></td><td valign=top>The first identity that matched the request.</td></tr>
<tr><td valign=top><code>sourceIp</code></td><td><code>string</code></td><td valign=top>The IP of the computer making the request.</td></tr>
<tr><td valign=top><code>sourcePort</code></td><td><code>int</code></td><td valign=top>The port the request was made on.</td></tr>
<tr><td valign=top><code>destinationIp</code></td><td><code>string</code></td><td valign=top>The destination IP requested.</td></tr>
<tr><td valign=top><code>destinationPort</code></td><td><code>int</code></td><td valign=top>The destination port the request was made on.</td></tr>
<tr><td valign=top><code>categories</code></td><td><code>[string]</code></td><td valign=top>Which security categories, if any, matched against the destination IP address/port requested.</td></tr>
<tr><td valign=top><code>identityTypes</code></td><td><code>[string]</code></td><td valign=top>The type of identity that made the request. For example, Roaming Computer, Network, and so on. Available in version 3 and above.</td></tr>
<tr><td valign=top><code><b>p_log_type</b></code></td><td><code>string</code></td><td valign=top>Panther added field with type of log</td></tr>
<tr><td valign=top><code><b>p_row_id</b></code></td><td><code>string</code></td><td valign=top>Panther added field with unique id (within table)</td></tr>
<tr><td valign=top><code><b>p_event_time</b></code></td><td><code>timestamp</code></td><td valign=top>Panther added standardize event time (UTC)</td></tr>
<tr><td valign=top><code><b>p_parse_time</b></code></td><td><code>timestamp</code></td><td valign=top>Panther added standardize log parse time (UTC)</td></tr>
<tr><td valign=top><code>p_any_ip_addresses</code></td><td><code>[string]</code></td><td valign=top>Panther added field with collection of ip addresses associated with the row</td></tr>
<tr><td valign=top><code>p_any_domain_names</code></td><td><code>[string]</code></td><td valign=top>Panther added field with collection of domain names associated with the row</td></tr>
<tr><td valign=top><code>p_any_sha1_hashes</code></td><td><code>[string]</code></td><td valign=top>Panther added field with collection of SHA1 hashes associated with the row</td></tr>
<tr><td valign=top><code>p_any_md5_hashes</code></td><td><code>[string]</code></td><td valign=top>Panther added field with collection of MD5 hashes associated with the row</td></tr>
<tr><td valign=top><code>p_any_sha256_hashes</code></td><td><code>[string]</code></td><td valign=top>Panther added field with collection of SHA256 hashes of any algorithm associated with the row</td></tr>
</table>

##CiscoUmbrella.Proxy
Proxy logs show traffic that has passed through the Umbrella Secure Web Gateway or the Selective Proxy.
Reference: https://docs.umbrella.com/deployment-umbrella/docs/log-formats-and-versioning#section-proxy-logs

<table>
<tr><th align=center>Column</th><th align=center>Type</th><th align=center>Description</th></tr>
<tr><td valign=top><code>timestamp</code></td><td><code>timestamp</code></td><td valign=top>The timestamp of the request transaction in UTC (2015-01-16 17:48:41).</td></tr>
<tr><td valign=top><code>identity</code></td><td><code>string</code></td><td valign=top>The first identity that matched the request.</td></tr>
<tr><td valign=top><code>identities</code></td><td><code>[string]</code></td><td valign=top>Which identities, in order of granularity, made the request through the intelligent proxy.</td></tr>
<tr><td valign=top><code>internalIp</code></td><td><code>string</code></td><td valign=top>The internal IP address of the computer making the request.</td></tr>
<tr><td valign=top><code>externalIp</code></td><td><code>string</code></td><td valign=top>The egress IP address of the network where the request originated.</td></tr>
<tr><td valign=top><code>destinationIp</code></td><td><code>string</code></td><td valign=top>The destination IP address of the request.</td></tr>
<tr><td valign=top><code>contentType</code></td><td><code>string</code></td><td valign=top>The type of web content, typically text/html.</td></tr>
<tr><td valign=top><code>verdict</code></td><td><code>string</code></td><td valign=top>Whether the destination was blocked or allowed.</td></tr>
<tr><td valign=top><code>url</code></td><td><code>string</code></td><td valign=top>The URL requested.</td></tr>
<tr><td valign=top><code>referrer</code></td><td><code>string</code></td><td valign=top>The referring domain or URL.</td></tr>
<tr><td valign=top><code>userAgent</code></td><td><code>string</code></td><td valign=top>The browser agent that made the request.</td></tr>
<tr><td valign=top><code>statusCode</code></td><td><code>int</code></td><td valign=top>The HTTP status code; should always be 200 or 201.</td></tr>
<tr><td valign=top><code>requestSize</code></td><td><code>bigint</code></td><td valign=top>Request size in bytes.</td></tr>
<tr><td valign=top><code>responseSize</code></td><td><code>bigint</code></td><td valign=top>Response size in bytes.</td></tr>
<tr><td valign=top><code>responseBodySize</code></td><td><code>bigint</code></td><td valign=top>Response body size in bytes.</td></tr>
<tr><td valign=top><code>sha</code></td><td><code>string</code></td><td valign=top>SHA256 hex digest of the response content.</td></tr>
<tr><td valign=top><code>categories</code></td><td><code>[string]</code></td><td valign=top>The security categories for this request, such as Malware.</td></tr>
<tr><td valign=top><code>avDetections</code></td><td><code>[string]</code></td><td valign=top>The detection name according to the antivirus engine used in file inspection.</td></tr>
<tr><td valign=top><code>puas</code></td><td><code>[string]</code></td><td valign=top>A list of all potentially unwanted application (PUA) results for the proxied file as returned by the antivirus scanner.</td></tr>
<tr><td valign=top><code>ampDisposition</code></td><td><code>string</code></td><td valign=top>The status of the files proxied and scanned by Cisco Advanced Malware Protection (AMP) as part of the Umbrella File Inspection feature; can be Clean, Malicious or Unknown.</td></tr>
<tr><td valign=top><code>ampMalwareName</code></td><td><code>string</code></td><td valign=top>If Malicious, the name of the malware according to AMP.</td></tr>
<tr><td valign=top><code>ampScore</code></td><td><code>string</code></td><td valign=top>The score of the malware from AMP. This field is not currently used and will be blank.</td></tr>
<tr><td valign=top><code>identityType</code></td><td><code>string</code></td><td valign=top>The type of identity that made the request. For example, Roaming Computer, Network, and so on.</td></tr>
<tr><td valign=top><code>blockedCategories</code></td><td><code>[string]</code></td><td valign=top>The categories that resulted in the destination being blocked. Available in version 4 and above.</td></tr>
<tr><td valign=top><code><b>p_log_type</b></code></td><td><code>string</code></td><td valign=top>Panther added field with type of log</td></tr>
<tr><td valign=top><code><b>p_row_id</b></code></td><td><code>string</code></td><td valign=top>Panther added field with unique id (within table)</td></tr>
<tr><td valign=top><code><b>p_event_time</b></code></td><td><code>timestamp</code></td><td valign=top>Panther added standardize event time (UTC)</td></tr>
<tr><td valign=top><code><b>p_parse_time</b></code></td><td><code>timestamp</code></td><td valign=top>Panther added standardize log parse time (UTC)</td></tr>
<tr><td valign=top><code>p_any_ip_addresses</code></td><td><code>[string]</code></td><td valign=top>Panther added field with collection of ip addresses associated with the row</td></tr>
<tr><td valign=top><code>p_any_domain_names</code></td><td><code>[string]</code></td><td valign=top>Panther added field with collection of domain names associated with the row</td></tr>
<tr><td valign=top><code>p_any_sha1_hashes</code></td><td><code>[string]</code></td><td valign=top>Panther added field with collection of SHA1 hashes associated with the row</td></tr>
<tr><td valign=top><code>p_any_md5_hashes</code></td><td><code>[string]</code></td><td valign=top>Panther added field with collection of MD5 hashes associated with the row</td></tr>
<tr><td valign=top><code>p_any_sha256_hashes</code></td><td><code>[string]</code></td><td valign=top>Panther added field with collection of SHA256 hashes of any algorithm associated with the row</td></tr>
</table>

